<!doctype html><html lang=en><head><meta charset=utf-8><link rel=preload href=https://ttntm.github.io/css/page.css as=style><link rel=preload href=https://ttntm.github.io/js/particles.min.js as=script><link rel=preconnect href=https://use.fontawesome.com/releases/v5.1.0/css/all.css><link rel=preconnect href=https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js><link rel=preconnect href=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js><link rel=preconnect href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=ttntm><meta name=robots content=index,follow><meta name=description content="An article about using CSS variables in Internet Explorer which doesn't natively support them."><meta name=twitter:card content=summary><meta name=twitter:site content=@thet0m><meta name=twitter:creator content=@thet0m><meta name=twitter:title content="Using CSS Variables in Internet Explorer"><meta name=twitter:description content="An article about using CSS variables in Internet Explorer which doesn't natively support them."><meta name=twitter:image content=https://ttntm.github.io/img/blog/default.jpg><base href=https://ttntm.github.io><title>Using CSS Variables in Internet Explorer | ttntm</title><link rel=apple-touch-icon sizes=180x180 href=https://ttntm.github.io/img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://ttntm.github.io/img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://ttntm.github.io/img/favicon/favicon-16x16.png><link rel=mask-icon href=https://ttntm.github.io/img/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#2b5797><meta name=theme-color content=#343a40><link rel=stylesheet href=https://ttntm.github.io/css/page.css><script src=https://ttntm.github.io/js/particles.min.js></script></head><body><a id=top></a><nav class="navbar navbar-expand-lg navbar-light bg-light"><a class=navbar-brand href=https://ttntm.github.io><i class="fas fa-cogs fa-2x text-blue"></i></a><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation"><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link text-center" href=https://ttntm.github.io>Home</a>
<a class="nav-item nav-link text-center" href=https://ttntm.github.io/post>Blog</a>
<a class="nav-item nav-link text-center" href=https://ttntm.github.io/about>About</a>
<a class="nav-item nav-link text-center" href=https://ttntm.github.io/about#contact>Contact</a></div></div><a class="text-blue d-none d-lg-block ml-3" href=https://twitter.com/thet0m data-toggle=tooltip title=Twitter aria-label=Twitter rel=noopener target=_blank><i class="fab fa-twitter fa-lg"></i></a><a class="text-blue d-none d-lg-block ml-3" href=https://github.com/ttntm data-toggle=tooltip title=GitHub aria-label=GitHub rel=noopener target=_blank><i class="fab fa-github fa-lg"></i></a><a class="text-blue d-none d-lg-block ml-3" href=https://codepen.io/ttntm/ data-toggle=tooltip title=CodePen aria-label=CodePen rel=noopener target=_blank><i class="fab fa-codepen fa-lg"></i></a><a class="text-blue d-none d-lg-block ml-3" href=https://www.freecodecamp.org/ttntm data-toggle=tooltip title=freeCodeCamp aria-label=freeCodeCamp rel=noopener target=_blank><i class="fab fa-free-code-camp fa-lg"></i></a></nav><header class="header blog-header"><div class=container><div class="row justify-content-center blog-title"><div class="col align-self-center py-3 text-md-center text-secondary"><h1 class="text-blue py-1 my-2">Using CSS Variables in Internet Explorer</h1><p class="py-1 my-2">Published 03.09.2018, 3 minute read<p class="text-dark py-1 my-2">An article about using CSS variables in Internet Explorer which doesn&#39;t natively support them.</div></div></div></header><div class=container><div class="row mt-3"><div class="col pt-3 mkd"><h2 id=using-css-variables>Using CSS variables</h2><p>CSS variables (see: <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>w3schools.com&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a>) make working with stylesheets easier, no doubt about that. Defining a color, a breakpoint or even a font-family globally, makes changes easier and almost completely eliminates the copy/paste and the find/replace cycle when it comes to updates in your CSS.<p>Now, having to support Internet Explorer 11 and below with your CSS makes this a little less exciting, as it simply doesn&rsquo;t support CSS variables at all.<p>But: not supporting IE 11 and below is not really an option yet. Even more so, if many of your site&rsquo;s potential visitors are likely to be corporate users who may not even have another choice and who haven&rsquo;t upgraded to Windows 10/Edge yet.<h3 id=supporting-internet-explorer>Supporting Internet Explorer</h3><p>In order to support IE, one could use CSS variables in development but provide production CSS without them in it, running it through Sass/CSS processing at build time.<p>If you&rsquo;re working on a smaller project or if you don&rsquo;t want to use any Sass/CSS processing in your site&rsquo;s build process, there&rsquo;s still another option that will be explained here: leaving the variables in your CSS and making sure IE will understand them.<p>In order to achieve that, we&rsquo;re going to do the following:<ol><li>check whether or not IE is being used to view our site<li>add a ponyfill to process the CSS variables in case that&rsquo;s true</ol><p>That way, we&rsquo;re not generating another HTTP request for the rest of our potential visitors using other browsers.<h4 id=check-for-ie>Check for IE</h4><p>In order to check for IE, we&rsquo;re going to add the following JavaScript to our site&rsquo;s <code>&lt;head&gt;</code>:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>checkForIE</span>();
            
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>insert</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementsByTagName</span>(<span style=color:#e6db74>&#39;head&#39;</span>)[<span style=color:#ae81ff>0</span>];
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>script</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;script&#39;</span>);
            <span style=color:#a6e22e>script</span>.<span style=color:#a6e22e>setAttribute</span>(<span style=color:#e6db74>&#39;src&#39;</span>, <span style=color:#e6db74>&#39;/js/css-vars-ponyfill.min.js&#39;</span>);
            <span style=color:#a6e22e>insert</span>.<span style=color:#a6e22e>appendChild</span>(<span style=color:#a6e22e>script</span>);
            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;IE found, adding ponyfill.&#39;</span>)
        } <span style=color:#66d9ef>else</span> {
            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;This is not the IE you are looking for...&#39;</span>)
        }
            
        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>checkForIE</span>() {
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ua</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>userAgent</span>;
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>msie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;MSIE &#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>msie</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
                <span style=color:#75715e>// IE 10 or older =&gt; return version number
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> parseInt(<span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>substring</span>(<span style=color:#a6e22e>msie</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;.&#39;</span>, <span style=color:#a6e22e>msie</span>)), <span style=color:#ae81ff>10</span>);
            }
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>trident</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;Trident/&#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>trident</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
                <span style=color:#75715e>// IE 11 =&gt; return version number
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;rv:&#39;</span>);
                <span style=color:#66d9ef>return</span> parseInt(<span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>substring</span>(<span style=color:#a6e22e>rv</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>, <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;.&#39;</span>, <span style=color:#a6e22e>rv</span>)), <span style=color:#ae81ff>10</span>);
            }
            <span style=color:#75715e>// all the other browsers
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
        }
</code></pre></div><p>The function <code>checkForIE()</code> shown above, makes sure we don&rsquo;t miss any Internet Explorer 11 and below.<p>Depending on the outcome of that function, a ponyfill that provides CSS variable support gets added to the DOM.<p>Most of the code above is based on this helpful resource found on CodePen: <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>codepen.io/gapcode/pen/vEJNZN&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a><h4 id=the-ponyfill>The Ponyfill</h4><p>According to <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>this&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a>, a so called &ldquo;Ponyfill&rdquo; &ldquo;doesn&rsquo;t monkey patch anything, but instead exports the functionality as a normal module, so you can use it locally without affecting other code&rdquo;.<p>The one used here is called &ldquo;css-vars-ponyfill&rdquo; and comes from this repository on GitHub: <a href=https://github.com/jhildenbiddle/css-vars-ponyfill rel=noopener target=_blank>github.com/jhildenbiddle/css-vars-ponyfill&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a><p>Simply adding the ponyfill to a page won&rsquo;t do the trick, it also has to be executed via <code>cssVars()</code>. The site this example came from is also using jQuery, so this call has been placed in <code>document.ready()</code>, which looks like that:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        <span style=color:#a6e22e>$</span>(document).<span style=color:#a6e22e>ready</span>(<span style=color:#66d9ef>function</span>(){
            <span style=color:#75715e>//some code...
</span><span style=color:#75715e></span>
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {<span style=color:#a6e22e>cssVars</span>();};
            
            <span style=color:#75715e>//some more code...
</span><span style=color:#75715e></span>        });
</code></pre></div><h3 id=conclusion>Conclusion</h3><p>Overall, this seems to be a rather convenient solution when it&rsquo;s necessary to make CSS variables work in legacy IE browsers.<p>In the end though, I don&rsquo;t think any of the above is relevant if you&rsquo;re using Sass and/or CSS processing in your build setup. I just haven&rsquo;t gotten around to digging into that yet, so it&rsquo;s a definitive advantage over the copy/paste and the find/replace cycle respectively.<hr><h4 id=update-10-09-2018>Update 10.09.2018</h4><p>For some reason, <code>$(document).ready()</code> didn&rsquo;t fire consistently enough - it could happen, that <code>cssVars()</code> never got executed and the site rendered without resolving the variable values.<p>Putting <code>cssVars()</code> into an <em>EventListener</em> instead helped here:<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;load&#39;</span>, <span style=color:#66d9ef>function</span>() {
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {
                <span style=color:#a6e22e>cssVars</span>();
            }
        });
</code></pre></div></div></div><div class="row mt-3 mb-3 blog-meta"><div class="col-sm-12 col-md mt-3 mb-3 text-left"><ul class="list-inline my-0"><li class=list-inline-item><h5 class=my-0>Share this Article:</h5><li class=list-inline-item><a href="https://twitter.com/intent/tweet?text=Using%20CSS%20Variables%20in%20Internet%20Explorer&amp;url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Twitter" aria-label="Share on Twitter" data-toggle=tooltip data-placement=bottom rel=noopener target=_blank><i class="fab fa-twitter-square fa-lg"></i></a><li class=list-inline-item><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f&amp;title=Using%20CSS%20Variables%20in%20Internet%20Explorer" title="Share on LinkedIn" aria-label="Share on LinkedIn" data-toggle=tooltip data-placement=bottom rel=noopener target=_blank><i class="fab fa-linkedin fa-lg"></i></a><li class=list-inline-item><a href="https://plus.google.com/share?url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Google+" aria-label="Share on Google+" data-toggle=tooltip data-placement=bottom rel=noopener target=_blank><i class="fab fa-google-plus-square fa-lg"></i></a><li class=list-inline-item><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Facebook" aria-label="Share on Facebook" data-toggle=tooltip data-placement=bottom rel=noopener target=_blank><i class="fab fa-facebook fa-lg"></i></a><li class=list-inline-item><a href="mailto:?subject=Using%20CSS%20Variables%20in%20Internet%20Explorer&amp;body=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Send as Email" aria-label="Send as Email" data-toggle=tooltip data-placement=bottom data-proofer-ignore><i class="fas fa-envelope-square fa-lg"></i></a></ul></div><div class="col-sm-12 col-md mt-3 mb-3 text-md-right"><ul class="list-inline my-0"><li class=list-inline-item><h5 class=my-0>Tags:</h5><li class=list-inline-item><a href=https://ttntm.github.io/tags/css>css</a>, <a href=https://ttntm.github.io/tags/post>post</a>, <a href=https://ttntm.github.io/tags/howto>howto</a></ul></div></div><div class="row mt-3 mb-5"><div class="col-6 mt-3 align-self-left text-left"><a class="btn btn-outline-secondary shadow-sm px-3" href=https://ttntm.github.io/post/fcc-certification/><i class="fas fa-angle-double-left fa-xs"></i>&nbsp;&nbsp;Previous Post</a></div><div class="col-6 mt-3 align-self-right text-right"><a class="btn btn-outline-secondary shadow-sm px-3" href=https://ttntm.github.io/post/tailwind-responsive-menu/>Next Post&nbsp;&nbsp;<i class="fas fa-angle-double-right fa-xs"></i></a></div></div></div><footer class="footer  text-dark small"><div class=container-fluid><div class=row><div class="col-sm-12 col-md mt-3 order-2 order-md-1 text-center text-md-left"><p>&copy; ttntm 2018, built with <a href=https://gohugo.io rel=noopener target=_blank>Hugo&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a></div><div class="col-sm-12 col-md mt-0 order-1 order-md-2 text-center align-self-center"><ul class="nav justify-content-center"><li class=nav-item><a class="text-blue nav-link" href=https://ttntm.github.io>Home</a><li class=nav-item><a class="text-blue nav-link" href=https://ttntm.github.io/post>Blog</a><li class=nav-item><a class="text-blue nav-link" href=https://ttntm.github.io/about>About</a><li><a class="page-scroll text-blue nav-link" href title="Back to Top">Back to Top</a></ul></div><div class="col-sm-12 col-md mt-3 order-3 order-md-3 text-center text-md-right"><ul class=list-inline><li class=list-inline-item><a class=text-blue href="javascript:linkTo_UnCryptMailto('nbjmup;uuounAqn/nf');" data-toggle=tooltip title=Email aria-label=Email><i class="fas fa-envelope fa-lg"></i></a><li class=list-inline-item><a class=text-blue href=https://twitter.com/thet0m data-toggle=tooltip title=Twitter aria-label=Twitter rel=noopener target=_blank><i class="fab fa-twitter fa-lg"></i></a><li class=list-inline-item><a class=text-blue href=https://github.com/ttntm data-toggle=tooltip title=GitHub aria-label=GitHub rel=noopener target=_blank><i class="fab fa-github fa-lg"></i></a><li class=list-inline-item><a class=text-blue href=https://codepen.io/ttntm/ data-toggle=tooltip title=CodePen aria-label=CodePen rel=noopener target=_blank><i class="fab fa-codepen fa-lg"></i></a><li class=list-inline-item><a class=text-blue href=https://www.freecodecamp.org/ttntm data-toggle=tooltip title=freeCodeCamp aria-label=freeCodeCamp rel=noopener target=_blank><i class="fab fa-free-code-camp fa-lg"></i></a></ul></div></div></div></footer><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.1.0/css/all.css integrity=sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt crossorigin=anonymous><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js integrity=sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js integrity=sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em crossorigin=anonymous></script><script>$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();});$('a.page-scroll').each(function(){$(this).click(function(){$('html,body').animate({scrollTop:0},'slow');return false;});});</script><script>function UnCryptMailto(t){for(var n=0,o="",r=0;r<t.length;r++)8364<=(n=t.charCodeAt(r))&&(n=128),o+=String.fromCharCode(n-1);return o}function linkTo_UnCryptMailto(t){location.href=UnCryptMailto(t)}</script></body></html>