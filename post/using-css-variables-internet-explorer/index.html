<!doctype html><html lang=en><head><meta charset=utf-8><link rel=preload href=https://ttntm.github.io/css/page.css as=style><link rel=preload href=https://ttntm.github.io/js/particles.min.js as=script><link rel=preconnect href=https://use.fontawesome.com/releases/v5.1.0/css/all.css><link rel=preconnect href=https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js><link rel=preconnect href=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js><link rel=preconnect href=https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js><link rel=preload href=https://fonts.gstatic.com/s/nunito/v9/XRXV3I6Li01BKofINeaB.woff2 as=font crossorigin=anonymous><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=ttntm><meta name=robots content=index,follow><meta name=description content="An article about using CSS variables in Internet Explorer which doesn't natively support them."><meta name=twitter:card content=summary><meta name=twitter:site content=@thet0m><meta name=twitter:creator content=@thet0m><meta name=twitter:title content="Using CSS Variables in Internet Explorer"><meta name=twitter:description content="An article about using CSS variables in Internet Explorer which doesn't natively support them."><meta name=twitter:image content=https://ttntm.github.io/img/blog/default.jpg><base href=https://ttntm.github.io><title>Using CSS Variables in Internet Explorer | ttntm</title><link rel=apple-touch-icon sizes=180x180 href=https://ttntm.github.io/img/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://ttntm.github.io/img/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://ttntm.github.io/img/favicon/favicon-16x16.png><link rel=mask-icon href=https://ttntm.github.io/img/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#497285><meta name=theme-color content=#fff><link rel=stylesheet href=https://ttntm.github.io/css/page.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><style>@font-face{font-family:nunito;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/nunito/v9/XRXV3I6Li01BKofINeaB.woff2) format('woff2')}body{font-family:nunito,sans-serif}</style><script src=https://ttntm.github.io/js/particles.min.js></script></head><body><header class="container px-0"><a id=top></a><nav class="navbar navbar-expand-lg navbar-light"><a class="w-50 navbar-brand" href=https://ttntm.github.io><strong class=text-wide>ttntm</strong></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarMain aria-controls=navbarMain aria-expanded=false aria-label="Toggle navigation"><span class=navbar-toggler-icon></span></button><div class="w-50 collapse navbar-collapse justify-content-start" id=navbarMain><div class=navbar-nav><a class="nav-link underline" href=https://ttntm.github.io/post><span class="text-wide px-3 mx-3">Blog</span></a>
<a class="nav-link underline" href=https://ttntm.github.io/about><span class="text-wide px-3 mx-3">About</span></a>
<a class="nav-link underline" href=https://ttntm.github.io/contact><span class="text-wide px-3 mx-3">Contact</span></a></div></div><a class="text-blue d-none d-lg-block ml-3" href=https://twitter.com/thet0m title=Twitter rel=noopener target=_blank><i class="fab fa-twitter"></i></a><a class="text-blue d-none d-lg-block ml-3" href=https://github.com/ttntm title=GitHub rel=noopener target=_blank><i class="fab fa-github"></i></a><a class="text-blue d-none d-lg-block ml-3" href=https://codepen.io/ttntm/ title=CodePen rel=noopener target=_blank><i class="fab fa-codepen"></i></a></nav></header><main><header class="w-100 header-blue" style=min-height:200px><div class="container d-flex flex-row" style=min-height:200px><div class="mx-auto my-auto align-self-center text-center py-4"><h1 class="text-superwide text-tertiary py-1 my-2">Using CSS Variables in Internet Explorer</h1><p class="py-1 my-2">Published 03.09.2018, 3 minute read</p><p class="lead py-1 my-2">An article about using CSS variables in Internet Explorer which doesn&#39;t natively support them.</p></div></div></header><div class=container><div class="row mt-3"><div class="col pt-3 mkd"><h2 id=using-css-variables>Using CSS variables</h2><p>CSS variables (see: <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>w3schools.com&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a>) make working with stylesheets easier, no doubt about that. Defining a color, a breakpoint or even a font-family globally, makes changes easier and almost completely eliminates the copy/paste and the find/replace cycle when it comes to updates in your CSS.</p><p>Now, having to support Internet Explorer 11 and below with your CSS makes this a little less exciting, as it simply doesn&rsquo;t support CSS variables at all.</p><p>But: not supporting IE 11 and below is not really an option yet. Even more so, if many of your site&rsquo;s potential visitors are likely to be corporate users who may not even have another choice and who haven&rsquo;t upgraded to Windows 10/Edge yet.</p><h3 id=supporting-internet-explorer>Supporting Internet Explorer</h3><p>In order to support IE, one could use CSS variables in development but provide production CSS without them in it, running it through Sass/CSS processing at build time.</p><p>If you&rsquo;re working on a smaller project or if you don&rsquo;t want to use any Sass/CSS processing in your site&rsquo;s build process, there&rsquo;s still another option that will be explained here: leaving the variables in your CSS and making sure IE will understand them.</p><p>In order to achieve that, we&rsquo;re going to do the following:</p><ol><li>check whether or not IE is being used to view our site</li><li>add a ponyfill to process the CSS variables in case that&rsquo;s true</li></ol><p>That way, we&rsquo;re not generating another HTTP request for the rest of our potential visitors using other browsers.</p><h4 id=check-for-ie>Check for IE</h4><p>In order to check for IE, we&rsquo;re going to add the following JavaScript to our site&rsquo;s <code>&lt;head&gt;</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>checkForIE</span>();
            
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>insert</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementsByTagName</span>(<span style=color:#e6db74>&#39;head&#39;</span>)[<span style=color:#ae81ff>0</span>];
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>script</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;script&#39;</span>);
            <span style=color:#a6e22e>script</span>.<span style=color:#a6e22e>setAttribute</span>(<span style=color:#e6db74>&#39;src&#39;</span>, <span style=color:#e6db74>&#39;/js/css-vars-ponyfill.min.js&#39;</span>);
            <span style=color:#a6e22e>insert</span>.<span style=color:#a6e22e>appendChild</span>(<span style=color:#a6e22e>script</span>);
            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;IE found, adding ponyfill.&#39;</span>)
        } <span style=color:#66d9ef>else</span> {
            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;This is not the IE you are looking for...&#39;</span>)
        }
            
        <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>checkForIE</span>() {
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ua</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>userAgent</span>;
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>msie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;MSIE &#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>msie</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
                <span style=color:#75715e>// IE 10 or older =&gt; return version number
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span> parseInt(<span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>substring</span>(<span style=color:#a6e22e>msie</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;.&#39;</span>, <span style=color:#a6e22e>msie</span>)), <span style=color:#ae81ff>10</span>);
            }
            <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>trident</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;Trident/&#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>trident</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
                <span style=color:#75715e>// IE 11 =&gt; return version number
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rv</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;rv:&#39;</span>);
                <span style=color:#66d9ef>return</span> parseInt(<span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>substring</span>(<span style=color:#a6e22e>rv</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span>, <span style=color:#a6e22e>ua</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#e6db74>&#39;.&#39;</span>, <span style=color:#a6e22e>rv</span>)), <span style=color:#ae81ff>10</span>);
            }
            <span style=color:#75715e>// all the other browsers
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
        }
</code></pre></div><p>The function <code>checkForIE()</code> shown above, makes sure we don&rsquo;t miss any Internet Explorer 11 and below.</p><p>Depending on the outcome of that function, a ponyfill that provides CSS variable support gets added to the DOM.</p><p>Most of the code above is based on this helpful resource found on CodePen: <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>codepen.io/gapcode/pen/vEJNZN&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a></p><h4 id=the-ponyfill>The Ponyfill</h4><p>According to <a href=https://github.com/sindresorhus/ponyfill rel=noopener target=_blank>this&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a>, a so called &ldquo;Ponyfill&rdquo; &ldquo;doesn&rsquo;t monkey patch anything, but instead exports the functionality as a normal module, so you can use it locally without affecting other code&rdquo;.</p><p>The one used here is called &ldquo;css-vars-ponyfill&rdquo; and comes from this repository on GitHub: <a href=https://github.com/jhildenbiddle/css-vars-ponyfill rel=noopener target=_blank>github.com/jhildenbiddle/css-vars-ponyfill&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a></p><p>Simply adding the ponyfill to a page won&rsquo;t do the trick, it also has to be executed via <code>cssVars()</code>. The site this example came from is also using jQuery, so this call has been placed in <code>document.ready()</code>, which looks like that:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        <span style=color:#a6e22e>$</span>(document).<span style=color:#a6e22e>ready</span>(<span style=color:#66d9ef>function</span>(){
            <span style=color:#75715e>//some code...
</span><span style=color:#75715e></span>
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {<span style=color:#a6e22e>cssVars</span>();};
            
            <span style=color:#75715e>//some more code...
</span><span style=color:#75715e></span>        });
</code></pre></div><h3 id=conclusion>Conclusion</h3><p>Overall, this seems to be a rather convenient solution when it&rsquo;s necessary to make CSS variables work in legacy IE browsers.</p><p>In the end though, I don&rsquo;t think any of the above is relevant if you&rsquo;re using Sass and/or CSS processing in your build setup. I just haven&rsquo;t gotten around to digging into that yet, so it&rsquo;s a definitive advantage over the copy/paste and the find/replace cycle respectively.</p><hr><h4 id=update-10-09-2018>Update 10.09.2018</h4><p>For some reason, <code>$(document).ready()</code> didn&rsquo;t fire consistently enough - it could happen, that <code>cssVars()</code> never got executed and the site rendered without resolving the variable values.</p><p>Putting <code>cssVars()</code> into an <em>EventListener</em> instead helped here:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>        window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;load&#39;</span>, <span style=color:#66d9ef>function</span>() {
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>MSLegacy</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) {
                <span style=color:#a6e22e>cssVars</span>();
            }
        });
</code></pre></div></div></div><div class="row mt-3 mb-3 blog-meta"><div class="col-sm-12 col-md mt-3 mb-3 text-left"><ul class="list-inline my-0"><li class=list-inline-item><h5 class=my-0>Share this Article:</h5></li><li class=list-inline-item><a href="https://twitter.com/intent/tweet?text=Using%20CSS%20Variables%20in%20Internet%20Explorer&amp;url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Twitter" rel=noopener target=_blank><i class="fab fa-twitter-square fa-lg"></i></a></li><li class=list-inline-item><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f&amp;title=Using%20CSS%20Variables%20in%20Internet%20Explorer" title="Share on LinkedIn" rel=noopener target=_blank><i class="fab fa-linkedin fa-lg"></i></a></li><li class=list-inline-item><a href="https://plus.google.com/share?url=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Google+" aria-label="Share on Google+" rel=noopener target=_blank><i class="fab fa-google-plus-square fa-lg"></i></a></li><li class=list-inline-item><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Share on Facebook" aria-label="Share on Facebook" rel=noopener target=_blank><i class="fab fa-facebook fa-lg"></i></a></li><li class=list-inline-item><a href="mailto:?subject=Using%20CSS%20Variables%20in%20Internet%20Explorer&amp;body=https%3a%2f%2fttntm.github.io%2fpost%2fusing-css-variables-internet-explorer%2f" title="Send as Email" data-proofer-ignore><i class="fas fa-envelope-square fa-lg"></i></a></li></ul></div><div class="col-sm-12 col-md mt-3 mb-3 text-md-right"><ul class="list-inline my-0"><li class=list-inline-item><h5 class=my-0>Tags:</h5></li><li class=list-inline-item><a href=https://ttntm.github.io/tags/css>css</a>, <a href=https://ttntm.github.io/tags/post>post</a>, <a href=https://ttntm.github.io/tags/howto>howto</a>, <a href=https://ttntm.github.io/tags/javascript>javascript</a></li></ul></div></div><div class="row mt-3 mb-5"><div class="col-6 mt-3 align-self-left text-left"><a class="btn btn-primary px-3" href=https://ttntm.github.io/post/fcc-certification/><i class="fas fa-angle-double-left fa-xs"></i>&nbsp;&nbsp;Previous Post</a></div><div class="col-6 mt-3 align-self-right text-right"><a class="btn btn-primary px-3" href=https://ttntm.github.io/post/tailwind-responsive-menu/>Next Post&nbsp;&nbsp;<i class="fas fa-angle-double-right fa-xs"></i></a></div></div></div></main><footer class="footer small"><div class=container><div class=row><div class="col-sm-12 col-md mt-3 order-2 order-md-1 text-center text-md-left"><p><i class="fas fa-copyright fa-sm text-blue"></i>&nbsp;ttntm 2018, built with <a href=https://gohugo.io rel=noopener target=_blank>Hugo&nbsp;<i class="fas fa-external-link-alt fa-xs"></i></a></p></div><div class="col-sm-12 col-md mt-0 order-1 order-md-2 text-center align-self-center"><ul class="nav justify-content-center text-wide"><li class=nav-item><a class=nav-link href=https://ttntm.github.io>Home</a></li><li class=nav-item><a class=nav-link href=https://ttntm.github.io/post>Blog</a></li><li class=nav-item><a class=nav-link href=https://ttntm.github.io/about>About</a></li><li class=nav-item><a class=nav-link href=https://ttntm.github.io/contact>Contact</a></li></ul></div><div class="col-sm-12 col-md mt-3 order-3 order-md-3 text-center text-md-right"><ul class=list-inline><li class=list-inline-item><a class="text-blue ml-md-1" href="javascript:linkTo_UnCryptMailto('nbjmup;uuounAqn/nf');" title=Email><i class="fas fa-envelope fa-lg"></i></a></li><li class=list-inline-item><a class="text-blue ml-md-1" href=https://twitter.com/thet0m title=Twitter rel=noopener target=_blank><i class="fab fa-twitter fa-lg"></i></a></li><li class=list-inline-item><a class="text-blue ml-md-1" href=https://github.com/ttntm title=GitHub rel=noopener target=_blank><i class="fab fa-github fa-lg"></i></a></li><li class=list-inline-item><a class="text-blue ml-md-1" href=https://codepen.io/ttntm/ title=CodePen rel=noopener target=_blank><i class="fab fa-codepen fa-lg"></i></a></li><li class=list-inline-item><a class="page-scroll text-blue ml-md-1" href title="Back to Top"><i class="fas fa-arrow-alt-circle-up fa-lg"></i></a></li></ul></div></div></div></footer><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Nunito"><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.1.0/css/all.css integrity=sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt crossorigin=anonymous><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js integrity=sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js integrity=sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em crossorigin=anonymous></script><script>$(document).ready(function(){var btn=$('.navbar-toggler');var icon=$('.navbar-toggler-icon');var navParent=$('.navbar');let shadow='shadow-sm'
btn.click(function(){if(navParent.hasClass(shadow)){navParent.removeClass(shadow);}else{navParent.addClass(shadow);}});$('a.page-scroll').each(function(){$(this).click(function(){$('html,body').animate({scrollTop:0},'slow');return false;});});});</script><script>function UnCryptMailto(t){for(var n=0,o="",r=0;r<t.length;r++)8364<=(n=t.charCodeAt(r))&&(n=128),o+=String.fromCharCode(n-1);return o}function linkTo_UnCryptMailto(t){location.href=UnCryptMailto(t)}</script></body></html>